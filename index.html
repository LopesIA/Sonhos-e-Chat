<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Guia de Sonhos & Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Estilos DinÃ¢micos -->
    <style id="estilos-dinamicos"></style>
</head>
<body>

    <!-- LOADING -->
    <div id="loadingOverlay" class="loading-screen">
        <div class="crystal-ball-loader">ğŸ”®</div>
        <p>Conectando ao Plano Astral...</p>
    </div>

    <div class="app-container">
        
        <!-- HEADER -->
        <header class="top-bar">
            <h1 class="mystic-title">Guia de Sonhos</h1>
            <div class="header-actions">
                <!-- Mostra o ID do usuÃ¡rio para facilitar identificaÃ§Ã£o -->
                <div class="user-id-display">ID: <span id="headerUserId">...</span></div>
            </div>
        </header>

        <!-- 1. TELA SONHOS (HOME) -->
        <section id="tab-sonhos" class="screen active">
            <div class="oracle-container">
                <div class="crystal-ball-wrapper">
                    <div class="crystal-ball">
                        <div class="glimmer"></div>
                    </div>
                    <div class="ball-shadow"></div>
                </div>
                
                <h2 class="oracle-text">Conte seu sonho...</h2>
                <div class="input-group">
                    <input type="text" id="dreamInput" placeholder="Ex: Estava voando sobre o mar..." autocomplete="off">
                    <button onclick="consultarOraculoIA()" class="btn-mystic">Revelar Significado</button>
                </div>

                <div id="dreamResult" class="dream-result hidden">
                    <h3>ğŸ‘ï¸ O OrÃ¡culo Responde:</h3>
                    <p id="resultText"></p>
                    <div id="loadingOraculo" class="hidden">âœ¨ Consultando os espÃ­ritos da IA...</div>
                </div>
            </div>
        </section>

        <!-- 2. TELA CHAT (REAL) -->
        <section id="tab-chat" class="screen">
            <div class="chat-wrapper">
                <div id="chatMessages" class="chat-messages">
                    <!-- Mensagens via Socket.io aparecem aqui -->
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chatInput" placeholder="Sua mensagem...">
                    <button onclick="enviarMensagemSocket()" class="btn-send">â¤</button>
                </div>
            </div>
        </section>

        <!-- 3. TELA PERFIL -->
        <section id="tab-perfil" class="screen">
            <div class="profile-header">
                <!-- Avatar clicÃ¡vel para trocar foto -->
                <div class="profile-pic-wrapper" id="meuAvatarWrapper" onclick="document.getElementById('fileInput').click()">
                    <!-- A moldura e a imagem sÃ£o injetadas via JS -->
                    <img src="https://i.pravatar.cc/150?img=12" id="imgAvatar" alt="Avatar">
                    <div class="edit-icon">ğŸ“·</div>
                </div>
                <input type="file" id="fileInput" hidden accept="image/*" onchange="trocarFoto(this)">
                
                <!-- Nome EditÃ¡vel -->
                <div class="name-edit-container">
                    <input type="text" id="inputNomePerfil" value="Viajante" onblur="salvarNome()">
                    <span class="edit-pencil">âœ</span>
                </div>
                
                <!-- BalÃ£o Equipado Preview -->
                <div id="previewBalaoPerfil" class="perfil-balao-preview">
                    "Assim serÃ¡ minha mensagem no chat!"
                </div>
            </div>

            <div class="inventory-section">
                <h3>ğŸ–¼ï¸ Minhas Conquistas (Molduras)</h3>
                <div class="inventory-grid" id="gridMoldurasAdquiridas"></div>
            </div>

            <div class="inventory-section">
                <h3>ğŸ’¬ Meus Estilos (BalÃµes)</h3>
                <div class="inventory-grid" id="gridBaloesAdquiridos"></div>
            </div>
        </section>

        <!-- 4. TELA LOJA (COMPLETA) -->
        <section id="tab-loja" class="screen">
            <div class="shop-header">
                <h2>Loja do Destino</h2>
                <p>Assista para ganhar um item aleatÃ³rio!</p>
                <button class="btn-watch" onclick="assistirAnuncio()">ğŸ“º ASSISTA E GANHE</button>
            </div>

            <div class="shop-category">
                <h3>ğŸ–¼ï¸ Todas as Molduras</h3>
                <div class="inventory-grid" id="lojaMoldurasTodas">
                    <!-- JS vai preencher com todas as molduras -->
                </div>
            </div>

            <div class="shop-category">
                <h3>ğŸ’¬ Todos os BalÃµes</h3>
                <div class="inventory-grid" id="lojaBaloesTodos">
                    <!-- JS vai preencher com todos os balÃµes -->
                </div>
            </div>
        </section>

        <!-- NAVEGAÃ‡ÃƒO -->
        <nav class="bottom-nav">
            <button onclick="mudarAba('sonhos')" class="nav-item active">ğŸ”® <span>OrÃ¡culo</span></button>
            <button onclick="mudarAba('chat')" class="nav-item">ğŸ’¬ <span>Chat</span></button>
            <button onclick="mudarAba('perfil')" class="nav-item">ğŸ‘¤ <span>Perfil</span></button>
            <button onclick="mudarAba('loja')" class="nav-item">ğŸ›’ <span>Loja</span></button>
        </nav>

    </div>

    <!-- MODAL DE VISUALIZAR PERFIL DE OUTRO -->
    <div id="modalPerfilOutro" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="fecharModal('modalPerfilOutro')">&times;</span>
            <div id="outroAvatarWrapper" class="profile-pic-wrapper large"></div>
            <h3 id="outroNome">Nome</h3>
            <p>Conquistas:</p>
            <div id="outroConquistas" class="badges-row"></div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>